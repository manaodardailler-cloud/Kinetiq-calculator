<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Calculateur Points Kinetiq</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  >
  <style>
  :root {
    color-scheme: dark;
    --bg-1: #071224;
    --bg-2: #020617;
    --card: rgba(5, 10, 24, 0.74);
    --stroke: rgba(148, 163, 184, 0.18);
    --text: #e5e7eb;
    --muted: #cbd5f5;
    --accent: #3b82f6;
    --accent-2: #22d3ee;
    --warning: #f87171;
    --result: #bae6fd;
  }

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    min-height: 100vh;
    font-family: "Space Grotesk", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background:
      radial-gradient(1200px 700px at 20% 10%, rgba(34, 211, 238, 0.12), transparent 55%),
      radial-gradient(900px 500px at 80% 0%, rgba(59, 130, 246, 0.14), transparent 50%),
      linear-gradient(135deg, rgba(2, 6, 23, 0.78), rgba(2, 6, 23, 0.72)),
      url("mnt.jpeg") center / cover no-repeat;
    background-attachment: fixed;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    color: var(--text);
    padding: 32px 18px 140px;
    overflow-x: hidden;
  }

  .layout {
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 32px;
    width: min(980px, 100%);
  }

  .side-panel {
    display: flex;
    flex-direction: row;
    gap: 18px;
    width: 100%;
  }

  .panel {
    background: rgba(5, 10, 24, 0.7);
    border-radius: 20px;
    padding: 20px 18px;
    box-shadow:
      0 24px 60px rgba(1, 5, 20, 0.55),
      inset 0 0 0 1px var(--stroke);
    flex: 1;
  }

  .leaderboard {
    width: auto;
  }

  .leaderboard h3,
  .break-even h3 {
    margin: 0 0 12px;
    font-size: 16px;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    color: var(--muted);
  }

  .break-even .actions {
    margin-top: 16px;
  }

  .podium {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    align-items: end;
    margin-bottom: 16px;
  }

  .podium-slot {
    background: rgba(2, 6, 23, 0.6);
    border-radius: 14px;
    padding: 10px 8px;
    text-align: center;
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.12);
  }

  .podium-slot .rank {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(226, 232, 240, 0.6);
  }

  .podium-slot .name {
    font-weight: 700;
    margin: 6px 0 2px;
  }

  .podium-slot .score {
    font-size: 12px;
    color: var(--result);
  }

  .podium-slot.first {
    min-height: 110px;
    background: linear-gradient(135deg, rgba(34, 211, 238, 0.22), rgba(59, 130, 246, 0.25));
    box-shadow: 0 12px 26px rgba(34, 211, 238, 0.25);
  }

  .podium-slot.second {
    min-height: 92px;
  }

  .podium-slot.third {
    min-height: 84px;
  }

  .leaderboard-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 10px 8px;
    border-radius: 12px;
    background: rgba(2, 6, 23, 0.6);
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.12);
  }

  .leaderboard-item + .leaderboard-item {
    margin-top: 10px;
  }

  .leaderboard-item .rank-badge {
    width: 22px;
    height: 22px;
    border-radius: 999px;
    background: rgba(59, 130, 246, 0.25);
    display: grid;
    place-items: center;
    font-size: 11px;
    font-weight: 700;
    color: var(--text);
  }

  .leaderboard-name {
    font-weight: 600;
  }

  .leaderboard input {
    width: 96px;
    margin: 0;
    padding: 8px 10px;
    border-radius: 10px;
    border: none;
    background: rgba(2, 6, 23, 0.9);
    color: var(--text);
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.2);
    text-align: right;
    font-size: 13px;
  }

  .leaderboard input:focus {
    outline: none;
    box-shadow: inset 0 0 0 1px var(--accent);
  }

  .bg-orbs {
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
    --x: 50%;
    --y: 50%;
  }

  .bg-orbs .orb {
    animation: orb-drift 16s ease-in-out infinite alternate;
  }

  .bg-orbs .orb.orb-2 {
    animation-duration: 20s;
  }

  .bg-orbs .orb.orb-3 {
    animation-duration: 18s;
  }

  @keyframes orb-drift {
    0% {
      transform: translate(-50%, -50%) translateX(-2%) translateY(0);
    }
    100% {
      transform: translate(-50%, -50%) translateX(2.5%) translateY(-1.5%);
    }
  }

  .waves {
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    background:
      radial-gradient(900px 400px at 20% 80%, rgba(56, 189, 248, 0.15), transparent 65%),
      radial-gradient(700px 320px at 70% 85%, rgba(14, 165, 233, 0.12), transparent 60%);
    mix-blend-mode: screen;
    opacity: 0.45;
    animation: waves-drift 18s ease-in-out infinite alternate;
  }

  .cursor-glow {
    position: fixed;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    opacity: 0.75;
    background: radial-gradient(220px 220px at var(--mx, 50%) var(--my, 50%), rgba(34, 211, 238, 0.22), transparent 70%);
    mix-blend-mode: screen;
    transition: opacity 0.3s ease;
  }

  @keyframes waves-drift {
    0% {
      transform: translateX(-2%) translateY(0);
    }
    100% {
      transform: translateX(2.5%) translateY(-1.5%);
    }
  }

  .orb {
    position: absolute;
    width: 520px;
    height: 520px;
    border-radius: 999px;
    filter: blur(10px);
    opacity: 0.65;
    transform: translate(-50%, -50%);
    transition: transform 0.25s ease, left 0.2s ease, top 0.2s ease;
    mix-blend-mode: screen;
  }

  .orb.orb-1 {
    left: 45%;
    top: 35%;
    background: radial-gradient(circle at 30% 30%, rgba(34, 211, 238, 0.8), rgba(59, 130, 246, 0.05) 60%);
  }

  .orb.orb-2 {
    left: 70%;
    top: 25%;
    width: 420px;
    height: 420px;
    background: radial-gradient(circle at 40% 40%, rgba(59, 130, 246, 0.7), rgba(15, 23, 42, 0.05) 60%);
  }

  .orb.orb-3 {
    left: 30%;
    top: 70%;
    width: 360px;
    height: 360px;
    background: radial-gradient(circle at 50% 50%, rgba(14, 165, 233, 0.6), rgba(2, 6, 23, 0.05) 65%);
  }

  .noise {
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='0.08'/%3E%3C/svg%3E");
    mix-blend-mode: soft-light;
    pointer-events: none;
    z-index: 0;
  }

  .token-field {
    position: fixed;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    overflow: hidden;
  }

  .token {
    position: absolute;
    top: -60px;
    width: 56px;
    height: 56px;
    border-radius: 999px;
    background: url("kntq-64.webp") center / cover no-repeat;
    box-shadow: 0 10px 30px rgba(34, 211, 238, 0.28);
    opacity: 0.9;
    transform: translateX(0) rotate(0deg);
    animation: token-fall var(--duration) linear forwards;
  }

  .token::before {
    content: "";
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    border: 1px solid rgba(255, 255, 255, 0.35);
    opacity: 0.5;
    pointer-events: none;
  }

  @keyframes token-fall {
    0% {
      transform: translateX(var(--drift)) translateY(-60px) rotate(0deg);
      opacity: 0;
    }
    10% {
      opacity: 0.9;
    }
    100% {
      transform: translateX(calc(var(--drift) * 1.4)) translateY(120vh) rotate(360deg);
      opacity: 0.15;
    }
  }

  .card {
    position: relative;
    z-index: 2;
    width: min(460px, 100%);
    margin-top: 48px;
    align-self: center;
    background: var(--card);
    backdrop-filter: blur(16px);
    border-radius: 24px;
    padding: 22px 24px 24px;
    box-shadow:
      0 30px 80px rgba(1, 5, 20, 0.72),
      inset 0 0 0 1px var(--stroke);
    transition: box-shadow 0.3s ease;
  }

  .card.result-glow {
    box-shadow:
      0 30px 80px rgba(1, 5, 20, 0.72),
      inset 0 0 0 1px rgba(34, 211, 238, 0.45),
      0 0 45px rgba(34, 211, 238, 0.35);
  }

  .title {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 12px;
  }

  .title-badge {
    width: 42px;
    height: 42px;
    border-radius: 14px;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.5), rgba(34, 211, 238, 0.6));
    display: grid;
    place-items: center;
    font-weight: 700;
    color: #030712;
    box-shadow: 0 12px 24px rgba(34, 211, 238, 0.2);
  }

  h2 {
    margin: 0;
    font-size: 22px;
    letter-spacing: 0.02em;
  }

  .subtitle {
    margin: 0 0 18px;
    text-align: center;
    color: var(--muted);
    font-size: 14px;
  }

  .field {
    margin-top: 12px;
  }

  .range-row {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 8px;
  }

  .range-row input[type="range"] {
    flex: 1;
    -webkit-appearance: none;
    appearance: none;
    height: 1px;
    border-radius: 999px;
    background:
      linear-gradient(90deg, hsl(var(--h, 190) 85% 62%), hsl(calc(var(--h, 190) + 35) 85% 62%)) 0 0 / var(--p, 0%) 100% no-repeat,
      linear-gradient(90deg, rgba(148, 163, 184, 0.12), rgba(148, 163, 184, 0.12));
    outline: none;
    box-shadow: none;
  }

  .range-row input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 6px;
    height: 6px;
    border-radius: 999px;
    background: rgba(224, 242, 254, 0.85);
    border: 1px solid rgba(34, 211, 238, 0.6);
    box-shadow:
      0 0 0 1px rgba(15, 23, 42, 0.55),
      0 3px 8px rgba(34, 211, 238, 0.2);
    cursor: pointer;
  }

  .range-row input[type="range"]::-moz-range-thumb {
    width: 6px;
    height: 6px;
    border-radius: 999px;
    background: rgba(224, 242, 254, 0.85);
    border: 1px solid rgba(34, 211, 238, 0.6);
    box-shadow:
      0 0 0 1px rgba(15, 23, 42, 0.55),
      0 3px 8px rgba(34, 211, 238, 0.2);
    cursor: pointer;
  }

  .range-row input[type="range"]::-moz-range-track {
    height: 1px;
    border-radius: 999px;
    background:
      linear-gradient(90deg, hsl(var(--h, 190) 85% 62%), hsl(calc(var(--h, 190) + 35) 85% 62%)) 0 0 / var(--p, 0%) 100% no-repeat,
      linear-gradient(90deg, rgba(148, 163, 184, 0.12), rgba(148, 163, 184, 0.12));
    box-shadow: none;
  }

  .range-value {
    min-width: 54px;
    text-align: right;
    font-size: 12px;
    color: var(--muted);
  }

  label {
    display: block;
    font-size: 13px;
    color: var(--muted);
  }

  .hint {
    margin-top: 6px;
    font-size: 12px;
    color: rgba(226, 232, 240, 0.6);
  }

  input {
    width: 100%;
    margin-top: 6px;
    padding: 11px 12px;
    border-radius: 12px;
    border: none;
    background: rgba(2, 6, 23, 0.9);
    color: var(--text);
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.2);
    transition: box-shadow 0.15s ease, transform 0.15s ease;
  }

  input:focus {
    outline: none;
    box-shadow: inset 0 0 0 1px var(--accent);
    transform: translateY(-1px);
  }

  input.input-error {
    box-shadow: inset 0 0 0 1px var(--warning);
  }

  .actions {
    display: flex;
    gap: 10px;
    margin-top: 22px;
  }

  button {
    flex: 1;
    padding: 12px 14px;
    border-radius: 14px;
    border: none;
    background: linear-gradient(135deg, var(--accent), var(--accent-2));
    color: #021024;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
  }

  button:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 28px rgba(34, 211, 238, 0.28);
  }

  .ghost {
    background: rgba(15, 23, 42, 0.7);
    color: var(--text);
    box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.2);
  }

  .result {
    margin-top: 20px;
    padding: 14px 16px;
    border-radius: 14px;
    background: rgba(15, 23, 42, 0.65);
    text-align: center;
    font-size: 16px;
    font-weight: 600;
    color: var(--result);
    min-height: 24px;
    opacity: 0;
    transform: translateY(6px);
    transition: opacity 0.2s ease, transform 0.2s ease;
  }

  .result.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .result-pulse {
    animation: result-pulse 0.7s ease;
  }

  @keyframes result-pulse {
    0% {
      transform: scale(0.98);
    }
    60% {
      transform: scale(1.02);
    }
    100% {
      transform: scale(1);
    }
  }

  .focus-dim .bg-orbs,
  .focus-dim .token-field,
  .focus-dim .noise {
    filter: saturate(0.75) brightness(0.85);
    opacity: 0.7;
    transition: opacity 0.2s ease, filter 0.2s ease;
  }

  .particle-field {
    position: fixed;
    inset: 0;
    z-index: 3;
    pointer-events: none;
    overflow: hidden;
  }

  .particle {
    position: absolute;
    width: 6px;
    height: 6px;
    border-radius: 999px;
    background: radial-gradient(circle, rgba(34, 211, 238, 0.95), rgba(59, 130, 246, 0.2));
    box-shadow: 0 0 12px rgba(34, 211, 238, 0.5);
    animation: particle-burst 900ms ease-out forwards;
  }

  .confetti-field {
    position: fixed;
    inset: 0;
    z-index: 4;
    pointer-events: none;
    overflow: hidden;
  }

  .confetti {
    position: absolute;
    width: 10px;
    height: 6px;
    border-radius: 2px;
    opacity: 0.95;
    transform: translateY(-20px) rotate(0deg);
    animation: confetti-fall var(--duration) ease-in forwards;
  }

  @keyframes confetti-fall {
    0% {
      transform: translateY(-20px) rotate(0deg);
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    100% {
      transform: translateY(120vh) rotate(540deg);
      opacity: 0.6;
    }
  }

  .flash {
    position: fixed;
    inset: 0;
    z-index: 5;
    pointer-events: none;
    background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.35), transparent 60%);
    opacity: 0;
  }

  .flash.active {
    animation: flash-pop 500ms ease-out;
  }

  @keyframes flash-pop {
    0% {
      opacity: 0;
    }
    30% {
      opacity: 0.75;
    }
    100% {
      opacity: 0;
    }
  }

  .card.shake {
    animation: card-shake 350ms ease;
  }

  @keyframes card-shake {
    0% { transform: translateX(0); }
    20% { transform: translateX(-4px); }
    40% { transform: translateX(4px); }
    60% { transform: translateX(-3px); }
    80% { transform: translateX(3px); }
    100% { transform: translateX(0); }
  }
  .flyer-field {
    position: fixed;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    overflow: hidden;
  }

  .flyer {
    position: absolute;
    top: 12%;
    width: 64px;
    height: 64px;
    background: url("jic.webp") center / contain no-repeat;
    opacity: 0.9;
    filter: drop-shadow(0 8px 16px rgba(14, 165, 233, 0.35));
    animation: flyer-pass var(--duration) linear forwards;
  }

  @keyframes flyer-pass {
    0% {
      transform: translateX(-15vw) translateY(var(--offset)) rotate(-6deg);
      opacity: 0;
    }
    10% {
      opacity: 0.95;
    }
    100% {
      transform: translateX(115vw) translateY(calc(var(--offset) * -0.35)) rotate(6deg);
      opacity: 0;
    }
  }

  @keyframes particle-burst {
    0% {
      transform: translate(0, 0) scale(1);
      opacity: 1;
    }
    100% {
      transform: translate(var(--dx), var(--dy)) scale(0.2);
      opacity: 0;
    }
  }

  @media (max-width: 520px) {
    .layout {
      align-items: stretch;
    }

    .side-panel {
      width: 100%;
      flex-direction: column;
    }

    .card {
      padding: 22px 20px 26px;
      border-radius: 20px;
    }

    .actions {
      flex-direction: column;
    }
  }
  </style>

</head>

<body>
<div class="bg-orbs" id="bgOrbs" aria-hidden="true">
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>
</div>
<div class="waves" aria-hidden="true"></div>
<div class="noise" aria-hidden="true"></div>
<div class="cursor-glow" id="cursorGlow" aria-hidden="true"></div>
<div class="token-field" id="tokenField" aria-hidden="true"></div>
<div class="particle-field" id="particleField" aria-hidden="true"></div>
<div class="flyer-field" id="flyerField" aria-hidden="true"></div>
<div class="confetti-field" id="confettiField" aria-hidden="true"></div>
<div class="flash" id="flash" aria-hidden="true"></div>
<div class="layout">
  <div class="side-panel">
    <aside class="leaderboard panel">
      <h3>Classement Kpoints</h3>
      <div class="podium" id="podium"></div>
      <div id="leaderboardList"></div>
      <div class="actions">
        <button type="button" class="ghost" id="saveLeaderboard">Enregistrer</button>
      </div>
    </aside>

    <section class="break-even panel">
      <h3>Seuil de rentabilit√©</h3>
      <div class="field" style="margin-top: 0;">
        <label for="fees">Frais d√©pens√©s ($)</label>
        <input type="number" id="fees" inputmode="decimal" placeholder="250">
      </div>

      <div class="field">
        <label for="pointsBreak">Nombre de points</label>
        <input type="number" id="pointsBreak" inputmode="decimal" placeholder="50000">
      </div>

      <div class="actions">
        <button type="button" onclick="calculerRentabilite()">Calculer seuil</button>
      </div>

      <div class="result" id="breakEvenResult" aria-live="polite"></div>
    </section>
  </div>

  <div class="card">
  <div class="title">
    <div class="title-badge">KQ</div>
    <h2>Calculateur de valeur Kinetiq</h2>
  </div>
  <p class="subtitle">Estime la valeur de ton airdrop en 10 secondes.</p>

  <div class="field">
    <label for="weeks">Nombre de semaines</label>
    <input type="number" id="weeks" inputmode="numeric" placeholder="12">
    <div class="range-row">
      <input type="range" id="weeksRange" min="14" max="32" step="1" value="14">
      <div class="range-value" id="weeksRangeValue">14</div>
    </div>
  </div>

  <div class="field">
    <label for="airdropPercent">Pourcentage d‚Äôairdrop</label>
    <input type="number" id="airdropPercent" inputmode="decimal" placeholder="5">
    <div class="range-row">
      <input type="range" id="airdropRange" min="5" max="20" step="0.5" value="5">
      <div class="range-value" id="airdropRangeValue">5</div>
    </div>
  </div>

  <div class="field">
    <label for="fdv">FDV √† l‚Äôairdrop (en millions)</label>
    <input type="number" id="fdv" inputmode="decimal" placeholder="150">
    <div class="range-row">
      <input type="range" id="fdvRange" min="50" max="500" step="10" value="150">
      <div class="range-value" id="fdvRangeValue">150</div>
    </div>
  </div>

  <div class="field">
    <label for="points">Nombre de points</label>
    <input type="number" id="points" inputmode="decimal" placeholder="30000">
    <div class="range-row">
      <input type="range" id="pointsRange" min="0" max="20000" step="100" value="0">
      <div class="range-value" id="pointsRangeValue">0</div>
    </div>
  </div>

  <div class="actions">
    <button type="button" onclick="calculer(event)">Calculer</button>
    <button type="button" class="ghost" onclick="reinitialiser()">R√©initialiser</button>
  </div>

  <div class="result" id="result" aria-live="polite"></div>

  <script>
    function parseNumber(value) {
      if (!value) return NaN;
      return parseFloat(String(value).replace(",", "."));
    }

    function setResult(message) {
      const result = document.getElementById("result");
      result.innerText = message;
      result.classList.toggle("visible", Boolean(message));
      result.classList.remove("result-pulse");
      void result.offsetWidth;
      if (message) {
        result.classList.add("result-pulse");
      }
      const card = document.querySelector(".card");
      if (message) {
        card.classList.add("result-glow");
        window.setTimeout(() => card.classList.remove("result-glow"), 700);
      }
    }

    function markInvalid(input, isInvalid) {
      input.classList.toggle("input-error", isInvalid);
    }

    function bindRangePair(numberId, rangeId, valueId, suffix = "") {
      const numberInput = document.getElementById(numberId);
      const rangeInput = document.getElementById(rangeId);
      const valueEl = document.getElementById(valueId);
      const min = parseFloat(rangeInput.min);
      const max = parseFloat(rangeInput.max);

      function setValue(val) {
        const value = String(val);
        numberInput.value = value;
        rangeInput.value = value;
        valueEl.textContent = value + suffix;
        const num = parseFloat(value);
        const pct = Number.isFinite(num) ? ((num - min) / (max - min)) * 100 : 0;
        const clamped = Math.min(Math.max(pct, 0), 100);
        rangeInput.style.setProperty("--p", `${clamped}%`);
        rangeInput.style.setProperty("--h", `${190 + clamped * 0.7}`);
      }

      rangeInput.addEventListener("input", () => {
        setValue(rangeInput.value);
      });

      numberInput.addEventListener("input", () => {
        if (numberInput.value === "") return;
        setValue(numberInput.value);
      });

      setValue(rangeInput.value);
    }

    const particleField = document.getElementById("particleField");
    const confettiField = document.getElementById("confettiField");
    const flash = document.getElementById("flash");
    const podium = document.getElementById("podium");
    const leaderboardList = document.getElementById("leaderboardList");

    const participants = [
      { name: "zark", points: 1200 },
      { name: "noob to mil", points: 6000 },
      { name: "brokx", points: 7000 },
      { name: "farodo", points: 1200 }
    ];

    const rowMap = new Map();
    const saveLeaderboard = document.getElementById("saveLeaderboard");

    bindRangePair("weeks", "weeksRange", "weeksRangeValue");
    bindRangePair("airdropPercent", "airdropRange", "airdropRangeValue");
    bindRangePair("fdv", "fdvRange", "fdvRangeValue");
    bindRangePair("points", "pointsRange", "pointsRangeValue");

    function updatePodium(sorted) {
      podium.innerHTML = "";
      const podiumOrder = [
        { rank: 2, className: "second" },
        { rank: 1, className: "first" },
        { rank: 3, className: "third" }
      ];
      const podiumIcons = {
        1: "üèÜ",
        2: "ü•à",
        3: "ü•â"
      };

      podiumOrder.forEach((slot) => {
        const person = sorted[slot.rank - 1];
        const card = document.createElement("div");
        card.className = `podium-slot ${slot.className}`;
        card.innerHTML = `
          <div class="rank">${podiumIcons[slot.rank]} #${slot.rank}</div>
          <div class="name">${person ? person.name : "-"}</div>
          <div class="score">${person ? person.points : 0} KP</div>
        `;
        podium.appendChild(card);
      });
    }

    function buildLeaderboard() {
      participants.forEach((person) => {
        const row = document.createElement("div");
        row.className = "leaderboard-item";
        row.innerHTML = `
          <div class="rank-badge">-</div>
          <div class="leaderboard-name">${person.name}</div>
          <input type="number" value="${person.points}" inputmode="numeric" data-name="${person.name}">
        `;
        rowMap.set(person.name, row);
        leaderboardList.appendChild(row);
      });
    }

    function updateLeaderboardView(activeInput = null) {
      const sorted = [...participants].sort((a, b) => b.points - a.points);
      updatePodium(sorted);

      const listIcons = ["üèÜ", "ü•à", "ü•â"];
      sorted.forEach((person, index) => {
        const row = rowMap.get(person.name);
        if (!row) return;
        const badge = row.querySelector(".rank-badge");
        if (badge) badge.textContent = listIcons[index] || String(index + 1);
        const input = row.querySelector("input");
        if (input && input !== activeInput) input.value = person.points;
        leaderboardList.appendChild(row);
      });
    }

    buildLeaderboard();
    updateLeaderboardView();

    function applyLeaderboardChanges() {
      rowMap.forEach((row, name) => {
        const input = row.querySelector("input");
        const value = parseNumber(input ? input.value : "");
        const participant = participants.find((p) => p.name === name);
        if (participant) participant.points = Number.isFinite(value) ? value : participant.points;
      });
      updateLeaderboardView();
    }

    saveLeaderboard.addEventListener("click", () => {
      applyLeaderboardChanges();
    });

    function spawnParticles(x, y) {
      for (let i = 0; i < 22; i += 1) {
        const particle = document.createElement("div");
        particle.className = "particle";
        const angle = Math.random() * Math.PI * 2;
        const distance = 40 + Math.random() * 80;
        const dx = Math.cos(angle) * distance;
        const dy = Math.sin(angle) * distance;
        particle.style.left = `${x}px`;
        particle.style.top = `${y}px`;
        particle.style.setProperty("--dx", `${dx}px`);
        particle.style.setProperty("--dy", `${dy}px`);
        particleField.appendChild(particle);
        window.setTimeout(() => particle.remove(), 1000);
      }
    }

    function formatUsd(value) {
      return new Intl.NumberFormat("fr-FR", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }).format(value) + " $";
    }

    function animateCount(element, targetValue) {
      const duration = 900;
      const start = performance.now();
      const from = 0;
      function tick(now) {
        const progress = Math.min((now - start) / duration, 1);
        const value = from + (targetValue - from) * progress;
        element.innerText = "Valeur estim√©e de l‚Äôairdrop : " + formatUsd(value);
        if (progress < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    function spawnConfetti(intense = false) {
      const colors = [
        "#22d3ee",
        "#38bdf8",
        "#3b82f6",
        "#60a5fa",
        "#a5b4fc"
      ];
      const count = intense ? 180 : 90;
      for (let i = 0; i < count; i += 1) {
        const piece = document.createElement("div");
        piece.className = "confetti";
        const left = Math.random() * 100;
        const duration = (intense ? 3 : 3.5) + Math.random() * 2.5;
        const delay = Math.random() * 0.25;
        const width = 6 + Math.random() * 8;
        const height = 4 + Math.random() * 8;
        const rotation = Math.random() * 360;

        piece.style.left = `${left}vw`;
        piece.style.setProperty("--duration", `${duration}s`);
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.width = `${width}px`;
        piece.style.height = `${height}px`;
        piece.style.transform = `translateY(-20px) rotate(${rotation}deg)`;
        piece.style.animationDelay = `${delay}s`;

        confettiField.appendChild(piece);
        window.setTimeout(() => piece.remove(), (duration + delay + 0.2) * 1000);
      }
    }

    function calculer(event) {
      const inputWeeks = document.getElementById("weeks");
      const inputPercent = document.getElementById("airdropPercent");
      const inputFdv = document.getElementById("fdv");
      const inputPoints = document.getElementById("points");

      const A = parseNumber(inputWeeks.value);
      const B = parseNumber(inputPercent.value);
      const C = parseNumber(inputFdv.value);
      const D = parseNumber(inputPoints.value);

      markInvalid(inputWeeks, !A);
      markInvalid(inputPercent, !B);
      markInvalid(inputFdv, !C);
      markInvalid(inputPoints, !D);

      if (!A || !B || !C || !D) {
        setResult("Merci de remplir tous les champs.");
        return;
      }

      const valeur = (D * C * B / 100) / (0.8 * A);
      setResult("Valeur estim√©e de l‚Äôairdrop : " + formatUsd(0));
      const result = document.getElementById("result");
      animateCount(result, valeur);

      if (event && event.currentTarget) {
        const rect = event.currentTarget.getBoundingClientRect();
        const x = rect.left + rect.width / 2;
        const y = rect.top + rect.height / 2;
        spawnParticles(x, y);
      }
      spawnConfetti(true);
      if (flash) {
        flash.classList.remove("active");
        void flash.offsetWidth;
        flash.classList.add("active");
      }
      const card = document.querySelector(".card");
      if (card) {
        card.classList.remove("shake");
        void card.offsetWidth;
        card.classList.add("shake");
      }
    }

    function calculerRentabilite() {
      const inputFees = document.getElementById("fees");
      const inputPointsBreak = document.getElementById("pointsBreak");
      const fees = parseNumber(inputFees.value);
      const points = parseNumber(inputPointsBreak.value);

      markInvalid(inputFees, !fees);
      markInvalid(inputPointsBreak, !points);

      const result = document.getElementById("breakEvenResult");
      if (!fees || !points) {
        result.innerText = "Merci de remplir les deux champs.";
        result.classList.add("visible");
        return;
      }

      const valuePerPoint = fees / points;
      result.innerText = "Valeur minimale d‚Äôun point : " + formatUsd(valuePerPoint);
      result.classList.add("visible");
    }

    function reinitialiser() {
      document.getElementById("weeks").value = "";
      document.getElementById("airdropPercent").value = "";
      document.getElementById("fdv").value = "";
      document.getElementById("points").value = "";
      document.querySelectorAll("input").forEach((input) => markInvalid(input, false));
      setResult("");
    }

    const tokenField = document.getElementById("tokenField");

    function spawnToken() {
      const token = document.createElement("div");
      token.className = "token";
      const left = Math.random() * 100;
      const drift = Math.random() * 120 - 60;
      const duration = 6 + Math.random() * 6;
      const scale = 0.7 + Math.random() * 0.6;

      token.style.left = `${left}vw`;
      token.style.setProperty("--drift", `${drift}px`);
      token.style.setProperty("--duration", `${duration}s`);
      token.style.transform = `scale(${scale})`;

      tokenField.appendChild(token);

      window.setTimeout(() => {
        token.remove();
      }, (duration + 1) * 1000);
    }

    window.setInterval(spawnToken, 350);

    document.querySelectorAll("input").forEach((input) => {
      input.addEventListener("focus", () => document.body.classList.add("focus-dim"));
      input.addEventListener("blur", () => document.body.classList.remove("focus-dim"));
    });

    const cursorGlow = document.getElementById("cursorGlow");
    let glowRaf = null;

    function updateCursorGlow(event) {
      if (glowRaf) cancelAnimationFrame(glowRaf);
      glowRaf = requestAnimationFrame(() => {
        const x = Math.round((event.clientX / window.innerWidth) * 100);
        const y = Math.round((event.clientY / window.innerHeight) * 100);
        cursorGlow.style.setProperty("--mx", `${x}%`);
        cursorGlow.style.setProperty("--my", `${y}%`);
      });
    }

    window.addEventListener("mousemove", updateCursorGlow);
    window.addEventListener("touchmove", (event) => {
      if (event.touches && event.touches[0]) {
        updateCursorGlow(event.touches[0]);
      }
    });

    const flyerField = document.getElementById("flyerField");

    function spawnFlyer() {
      const flyer = document.createElement("div");
      flyer.className = "flyer";
      const duration = 6 + Math.random() * 4;
      const offset = Math.random() * 40 - 20;
      const top = 10 + Math.random() * 30;

      flyer.style.top = `${top}%`;
      flyer.style.setProperty("--duration", `${duration}s`);
      flyer.style.setProperty("--offset", `${offset}px`);

      flyerField.appendChild(flyer);
      window.setTimeout(() => flyer.remove(), (duration + 1) * 1000);
    }

    window.setInterval(spawnFlyer, 7000);
  </script>
  </div>
</div>
</body>
</html>

